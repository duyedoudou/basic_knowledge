## 深拷贝和浅拷贝

> 内容提要：1、可变类型；2、不可变类型；3、浅拷贝；4、深拷贝；5、栈内存和堆内存

#### 可变类型与不可变类型：

可变类型：列表，字典、可变集合

不可变类型：数字，字符串，元组、不可变集合(frozenset)
>
> 这里的可变不可变，是指内存中的那块内容（value）是否可以被改变
>

> 字典是可变对象，在下方的l.append(a)的操作中是把字典a 的引用传到列表l 中，当后续操作修改a[‘num’]的值的时候，l 中的值也会跟着改变，相当于浅拷贝。

![image-20190807092741879](/Users/mac/Library/Application Support/typora-user-images/image-20190807092741879.png)

#### 深拷贝和浅拷贝：

**浅拷贝**：3种形式

切片操作：`b = a[:] 或者b = [x for x in a]; `   copy 函数：`b = copy.copy(a); `工厂函数：`b = list(a);` 



**深拷贝**只有1种形式：copy 模块中的`deepcopy()函数`。

a= l[:]是`浅拷贝`，只拷贝了第一层的，当l[2]改变时(即第二层改变)，a也会跟着改变。

b的赋值就是`深拷贝`,b不会随l而变化。

![image-20190807093753077](/Users/mac/Library/Application Support/typora-user-images/image-20190807093753077.png)

`栈内存`中存放的只是该对象的访问地址，在`堆内存`中为这个值分配空间。

由于这种值的大小不固定，因此不能把它们保存到栈内存中。

但`内存地址`大小的固定的，因此可以将`内存地址`保存在栈内存中。

这样，当查询引用类型的变量时， 先从栈中读取`内存地址`， 然后再通过地址找到堆中的`值`。对于这种，我们把它叫做按引用访问。

浅拷贝只复制指向某个对象的引用地址，而不复制对象本身，新旧对象还是共享同一块内存。

但深拷贝会另外创造一个一模一样的对象，新对象跟原对象不共享内存，修改新对象不会改到原对象。

浅复制只复制一层对象的属性，而深复制则递归复制了所有层级。